(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{121:function(e,t,n){},122:function(e,t,n){e.exports={avaImg:"Posts_avaImg__19nYX"}},154:function(e,t,n){},155:function(e,t,n){},27:function(e,t,n){e.exports={Nav:"Nav_Nav__3AhGP",activeLink:"Nav_activeLink__NMa5k"}},279:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n.n(s),i=n(59),a=n.n(i),c=(n(154),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,280)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),s(e),r(e),i(e),a(e)}))}),o=(n(155),n(11)),u=n(27),l=n.n(u),d=n(0),j=function(){return Object(d.jsxs)("div",{className:l.a.Nav,children:[Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/profile",activeClassName:l.a.activeLink,children:"Profile"})}),Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/dialogs",activeClassName:l.a.activeLink,children:"Messages"})}),Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/users",activeClassName:l.a.activeLink,children:"Users"})}),Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/news",activeClassName:l.a.activeLink,children:"News"})}),Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/music",activeClassName:l.a.activeLink,children:"Music"})}),Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/settings",activeClassName:l.a.activeLink,children:"Settings"})})]})},b=n(7),h=function(){return Object(d.jsx)("div",{children:"News"})},p=function(){return Object(d.jsx)("div",{children:"Music"})},O=function(){return Object(d.jsx)("div",{children:"Settings"})},f=n(38),g=n(5),m={dialogsData:[{id:1,name:"Anna"},{id:2,name:"Nik"},{id:3,name:"Mike"},{id:4,name:"Dima"},{id:6,name:"Nino"}],messageData:[{id:1,message:"Hi!"},{id:2,message:"Yes"},{id:3,message:"No"},{id:4,message:"Love"},{id:5,message:"Look"}]},x=n(34),v=n.n(x),S=function(e){return Object(d.jsx)("div",{className:v.a.dialog,children:Object(d.jsx)(o.b,{to:"/dialogs/"+e.id,children:e.name})})},P=function(e){return Object(d.jsx)("div",{className:v.a.messages,children:e.message})},_=n(115),w=n(116),C=n(39),A=n(46),T=n.n(A),y=function(e){e.input;var t=e.meta,n=(e.child,Object(C.a)(e,["input","meta","child"])),s=t.touched&&t.error;return Object(d.jsxs)("div",{className:T.a.formControl+" "+(s?T.a.error:""),children:[Object(d.jsxs)("div",{children:[" ",n.children]}),Object(d.jsx)("div",{children:s&&Object(d.jsx)("span",{children:t.error})})]})},E=function(e){var t=e.input,n=(e.meta,e.child,Object(C.a)(e,["input","meta","child"]));return Object(d.jsx)(y,Object(g.a)(Object(g.a)({},e),{},{children:Object(d.jsx)("textarea",Object(g.a)(Object(g.a)({},t),n))}))},N=function(e){var t=e.input;e.meta,e.child,Object(C.a)(e,["input","meta","child"]);return Object(d.jsx)(y,Object(g.a)(Object(g.a)({},e),{},{children:Object(d.jsx)("input",Object(g.a)(Object(g.a)({},t),e))}))},D=function(e){if(!e)return"Field is required"},k=function(e){return function(t){if(t.length>e)return"Max length ".concat(e," symbols")}},U=k(50),I=Object(w.a)({form:"dialogMessageForm"})((function(e){return Object(d.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(d.jsx)("div",{children:Object(d.jsx)(_.a,{component:E,validate:[D,U],name:"newMessageBody",placeholder:"Enter yout message..."})}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{children:"Send"})})]})})),L=n(10),F=n(9),M=function(e){return{isAuth:e.Auth.isAuth}};function G(e){return Object(L.b)(M)((function(t){var n=t.isAuth,s=Object(C.a)(t,["isAuth"]);return n?Object(d.jsx)(e,Object(g.a)({},s)):Object(d.jsx)(b.a,{to:"/login"})}))}var R=Object(F.d)(Object(L.b)((function(e){return{messageData:e.messageData,isAuth:e.Auth.isAuth}}),(function(e){return{addMessage:function(t){e(function(e){return{type:"SEND_MESSAGE",newMessageBody:e}}(t))}}})),G)((function(e){var t=e.messageData.dialogsData.map((function(e){return Object(d.jsx)(S,{id:e.id,name:e.name},e.id)})),n=e.messageData.messageData.map((function(e){return Object(d.jsx)(P,{message:e.message},e.id)}));return 0==e.isAuth?Object(d.jsx)(b.a,{to:"/Login"}):Object(d.jsxs)("div",{className:v.a.containerDialogs,children:[Object(d.jsx)("div",{children:t}),Object(d.jsxs)("div",{children:[n,Object(d.jsx)(I,{onSubmit:function(t){e.addMessage(t.newMessageBody)}})]})]})})),z=n(22),H=n(23),B=n(25),Y=n(24),W=n(120),X=n.n(W).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"13158516-512e-4eb5-8351-d4d4ecf9c6e7"}}),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return X.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},q=function(e){return X.post("follow/".concat(e),{})},K=function(e){return X.delete("follow/".concat(e))},Z=function(e){return Q.getProfile(e)},Q={getProfile:function(e){return X.get("profile/"+e)},getStatus:function(e){return X.get("profile/status/"+e)},updateStatus:function(e){return X.put("profile/status/",{status:e})}},V=function(){return X.get("auth/me")},$=function(e,t,n){return X.post("auth/login",{email:e,password:t,rememberMe:n})},ee=function(){return X.delete("auth/login")},te={users:[],pageSize:50,totalUsersCount:0,currentPage:1,isFetching:!0,followingInProgress:[]},ne=function(e){return{type:"TOGLE_IS_FETCHING",isFetching:e}},se=function(e,t){return{type:"TOGLE_IS_FETCHING_PROGRESS",userId:e,isFetching:t}},re=n.p+"static/media/blank-profile-picture-973460_960_720.efadb13d.webp",ie=n(82),ae=n.n(ie),ce=function(e){for(var t=Math.ceil(e.totalUsersCount/e.pageSize),n=[],s=1;s<t;s++)n.push(s);return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{children:n.map((function(t){return Object(d.jsx)("span",{onClick:function(n){e.onPageChanged(t)},className:e.currentPage===t?ae.a.selectedNum:"",children:t})}))}),e.usersPage.map((function(t){return Object(d.jsxs)("div",{children:[Object(d.jsxs)("span",{children:[Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{to:"/profile/"+t.id,children:Object(d.jsx)("img",{src:null!=t.photos.small?t.photos.small:re,alt:"UserPhoto",className:ae.a.userImg})})}),Object(d.jsx)("div",{children:t.followed?Object(d.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.unfollow(t.id)},children:"UnFollow"}):Object(d.jsx)("button",{onClick:function(){e.follow(t.id)},children:"Follow"})})]}),Object(d.jsx)("span",{children:Object(d.jsxs)("span",{children:[Object(d.jsx)("div",{children:t.name}),Object(d.jsx)("div",{children:t.status})]})})]},t.id)}))]})},oe=n.p+"static/media/loader.fc860661.gif",ue=function(){return Object(d.jsx)("div",{children:Object(d.jsx)("img",{src:oe,style:{width:50}})})},le=function(e){Object(B.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(z.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onPageChanged=function(t){e.props.getUsersThunkCreator(t,e.props.pageSize)},e}return Object(H.a)(n,[{key:"componentDidMount",value:function(){this.props.getUsersThunkCreator(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{children:[this.props.isFetching?Object(d.jsx)(ue,{}):null," "]}),Object(d.jsx)("div",{children:Object(d.jsx)(ce,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,unfollow:this.props.unfollow,follow:this.props.follow,usersPage:this.props.usersPage,onPageChanged:this.onPageChanged,followingInProgress:this.props.followingInProgress,togleIsFollowingProgress:this.props.togleIsFollowingProgress})})]})}}]),n}(r.a.Component),de=Object(F.d)(Object(L.b)((function(e){return{usersPage:e.UsersPage.users,pageSize:e.UsersPage.pageSize,totalUsersCount:e.UsersPage.totalUsersCount,currentPage:e.UsersPage.currentPage,isFetching:e.UsersPage.isFetching,followingInProgress:e.UsersPage.followingInProgress}}),{follow:function(e){return function(t){t(se(e,!0)),q(e).then((function(n){0===n.data.resultCode&&t({type:"FOLLOW",userID:e}),t(se(e,!1))}))}},unfollow:function(e){return function(t){t(se(e,!0)),K(e).then((function(n){0===n.data.resultCode&&t({type:"UNFOLLOW",userID:e}),t(se(e,!1))}))}},setCurrentPage:function(e){return{type:"SET_CURRENTPAGE",currentPage:e}},togleIsFollowingProgress:se,getUsersThunkCreator:function(e,t){return function(n){n(ne(!0)),J(e,t).then((function(e){n({type:"SET_USERS",users:e.items}),n({type:"SET_TOTALCOUNT",count:e.totalCount}),n(ne(!1))}))}}}),G)(le),je=n(121),be=n.n(je),he=n(122),pe=n.n(he),Oe=function(e){return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:pe.a.avaImg,children:Object(d.jsx)("img",{src:"https://images.pexels.com/photos/33537/cat-animal-cat-portrait-mackerel.jpg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940",alt:"Ava"})}),Object(d.jsxs)("div",{children:[e.post," like ",e.like]})]})},fe={posts:[{id:1,post:"Hi!",like:3},{id:2,post:"Yo!",like:4},{id:3,post:"Like!",like:1}],profile:null,status:"",newPostText:""},ge=function(e){return{type:"SET_STATUS",status:e}},me=k(20),xe=Object(w.a)({form:"ProfileAddNewPostForm"})((function(e){return Object(d.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(d.jsx)(_.a,{component:E,name:"newPostText",validate:[D,me],placeholder:"Post message"}),Object(d.jsx)("span",{children:Object(d.jsx)("button",{children:"Send"})})]})})),ve=Object(L.b)((function(e){return{newPostText:e.postData.newPostText}}),(function(e){return{addPost:function(t){e(function(e){return{type:"ADD_POST",newPostText:e}}(t))}}}))((function(e){return Object(d.jsx)("div",{children:Object(d.jsx)(xe,{onSubmit:function(t){e.addPost(t.newPostText)}})})})),Se=r.a.createContext({}),Pe=function(){return Object(d.jsx)(Se.Consumer,{children:function(e){var t=e.getState().postData.posts.map((function(e){return Object(d.jsx)(Oe,{post:e.post,like:e.like})}));return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"My posts"}),Object(d.jsx)(ve,{}),t]})}})},_e=function(e){Object(B.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(z.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={editMode:!1,status:e.props.status},e.disActivateEditMode=function(){e.setState({editMode:!1}),e.props.updateStatus(e.state.status)},e.activateEditMode=function(){e.setState({editMode:!0})},e.onStatusChange=function(t){e.setState({status:t.currentTarget.value})},e}return Object(H.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){e.status!==this.props.status&&this.setState({status:this.props.status})}},{key:"render",value:function(){return Object(d.jsxs)("div",{children:[!this.state.editMode&&Object(d.jsx)("div",{children:Object(d.jsx)("span",{onDoubleClick:this.activateEditMode,children:this.props.status||"No status"})}),this.state.editMode&&Object(d.jsx)("div",{children:Object(d.jsx)("input",{onChange:this.onStatusChange,autoFocus:!0,onBlur:this.disActivateEditMode,value:this.state.status})})]})}}]),n}(r.a.Component),we=function(e){return e.profile?Object(d.jsxs)("div",{children:[Object(d.jsx)("img",{src:e.profile.photos.large}),Object(d.jsx)(_e,{status:e.status,updateStatus:e.updateStatus})]}):Object(d.jsx)(ue,{})},Ce=function(e){return Object(d.jsxs)("div",{className:be.a.mainProfile,children:[Object(d.jsx)(we,{profile:e.profile,status:e.status,updateStatus:e.updateStatus}),Object(d.jsx)(Pe,{})]})},Ae=function(e){Object(B.a)(n,e);var t=Object(Y.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(H.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.userId;e||(e=String(this.props.autorizedUserId)),this.props.getUserProfile(e),this.props.getStatus(e)}},{key:"render",value:function(){return Object(d.jsx)(Ce,Object(g.a)(Object(g.a)({},this.props),{},{profile:this.props.profile,status:this.props.status,updateStatus:this.props.updateStatus}))}}]),n}(r.a.Component),Te=Object(F.d)(Object(L.b)((function(e){return{profile:e.postData.profile,status:e.postData.status,autorizedUserId:e.Auth.id,isAuth:e.Auth.isAuth}}),{getUserProfile:function(e){return function(t){Z(e).then((function(e){t({type:"SET_USERPROFILE",profile:e.data})}))}},getStatus:function(e){return function(t){Q.getStatus(e).then((function(e){t(ge(e.data))}))}},updateStatus:function(e){return function(t){Q.updateStatus(e).then((function(n){0===n.data.resultCode&&t(ge(e))}))}}}),b.f,G)(Ae),ye=n(83),Ee=n.n(ye),Ne=function(e){return Object(d.jsxs)("div",{className:Ee.a.header,children:[Object(d.jsx)("img",{src:"https://images.pexels.com/photos/1162361/pexels-photo-1162361.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500",alt:"logo"}),Object(d.jsx)("div",{className:Ee.a.login,children:e.isAuth?Object(d.jsxs)("div",{children:[e.login," - ",Object(d.jsx)("button",{onClick:e.logout,children:"Log out"})]}):Object(d.jsx)(o.b,{to:"/login",children:"Login"})})]})},De=n(84),ke=n.n(De),Ue=n(123),Ie=n(32),Le={id:null,email:null,login:null,isAuth:!1},Fe=function(e,t,n,s){return{type:"SET_USERS_DATA",payload:{id:e,email:t,login:n,isAuth:s}}},Me=function(){return function(e){V().then((function(t){if(0===t.data.resultCode){var n=t.data.data,s=n.id,r=n.email,i=n.login;e(Fe(s,r,i,!0))}}))}},Ge=function(){return function(e){ee().then((function(t){0===t.data.resultCode&&e(Fe(null,null,null,!1))}))}},Re=function(e){Object(B.a)(n,e);var t=Object(Y.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object(H.a)(n,[{key:"componentDidMount",value:function(){this.props.getAuthUsersData()}},{key:"render",value:function(){return Object(d.jsx)(Ne,Object(g.a)(Object(g.a)({},this.props),{},{logout:Ge}))}}]),n}(r.a.Component),ze=Object(L.b)((function(e){return{isAuth:e.Auth.isAuth,login:e.Auth.login}}),{getAuthUsersData:Me,logout:Ge})(Re),He=Object(w.a)({form:"login"})((function(e){return Object(d.jsx)("div",{children:Object(d.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(d.jsx)("div",{children:Object(d.jsx)(_.a,{component:N,name:"email",placeholder:"email",validate:[D]})}),Object(d.jsx)("div",{children:Object(d.jsx)(_.a,{component:N,name:"password",placeholder:"password",validate:[D],type:"password"})}),Object(d.jsxs)("div",{children:[Object(d.jsx)(_.a,{component:N,name:"rememberMe",type:"checkbox",validate:[D]}),"remember me"]}),e.error&&Object(d.jsx)("div",{className:T.a.formSummaryError,children:e.error}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{children:"Login"})})]})})})),Be=Object(L.b)((function(e){return{isAuth:e.Auth.isAuth}}),{LoginTC:function(e,t,n){return function(){var s=Object(Ue.a)(ke.a.mark((function s(r){var i,a;return ke.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,$(e,t,n);case 2:0===(i=s.sent).data.resultCode?r(Me()):(a=i.data.data.messages.length>0?i.data.data.messages[0]:"Some error",r(Object(Ie.a)("login",{_error:a})));case 4:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()}})((function(e){return e.isAuth?Object(d.jsx)(b.a,{to:"/profile"}):Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Login"}),Object(d.jsx)(He,{onSubmit:function(t){e.LoginTC(t.email,t.password,t.rememberMe)}})]})}));var Ye=function(){return Object(d.jsx)(o.a,{children:Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(ze,{}),Object(d.jsxs)("div",{className:"InfContainer",children:[Object(d.jsx)(j,{}),Object(d.jsxs)("div",{className:"appMainContent",children:[Object(d.jsx)(b.b,{path:"/profile/:userId?",render:function(){return Object(d.jsx)(Te,{})}}),Object(d.jsx)(b.b,{path:"/dialogs",render:function(){return Object(d.jsx)(R,{})}}),Object(d.jsx)(b.b,{path:"/users",render:function(){return Object(d.jsx)(de,{})}}),Object(d.jsx)(b.b,{path:"/login",render:function(){return Object(d.jsx)(Be,{})}}),Object(d.jsx)(b.b,{path:"/news",render:function(){return Object(d.jsx)(h,{})}}),Object(d.jsx)(b.b,{path:"/music",render:function(){return Object(d.jsx)(p,{})}}),Object(d.jsx)(b.b,{path:"/settings",render:function(){return Object(d.jsx)(O,{})}})]})]})]})})},We=n(124),Xe=n(117),Je=Object(F.c)({postData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_POST":var n={id:2,post:t.newPostText,like:3},s=Object(g.a)(Object(g.a)({},e),{},{posts:[].concat(Object(f.a)(e.posts),[n]),newPostText:""});return s;case"SET_USERPROFILE":return Object(g.a)(Object(g.a)({},e),{},{profile:t.profile});case"SET_STATUS":return Object(g.a)(Object(g.a)({},e),{},{status:t.status});default:return e}},messageData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_MESSAGE":var n=t.newMessageBody;return Object(g.a)(Object(g.a)({},e),{},{messageData:[].concat(Object(f.a)(e.messageData),[{id:6,message:n}])});default:return e}},UsersPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FOLLOW":return Object(g.a)(Object(g.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userID?Object(g.a)(Object(g.a)({},e),{},{followed:!0}):e}))});case"UNFOLLOW":return Object(g.a)(Object(g.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userID?Object(g.a)(Object(g.a)({},e),{},{followed:!1}):e}))});case"SET_USERS":return Object(g.a)(Object(g.a)({},e),{},{users:t.users});case"SET_CURRENTPAGE":return Object(g.a)(Object(g.a)({},e),{},{currentPage:t.currentPage});case"SET_TOTALCOUNT":return Object(g.a)(Object(g.a)({},e),{},{totalUsersCount:t.count});case"TOGLE_IS_FETCHING":return Object(g.a)(Object(g.a)({},e),{},{isFetching:t.isFetching});case"TOGLE_IS_FETCHING_PROGRESS":return Object(g.a)(Object(g.a)({},e),{},{followingInProgress:t.isFetching?[].concat(Object(f.a)(e.followingInProgress),[t.userId]):e.followingInProgress.filter((function(e){return e!=t.userId}))});default:return e}},Auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS_DATA":return Object(g.a)(Object(g.a)({},e),t.payload);default:return e}},form:Xe.a}),qe=Object(F.e)(Je,Object(F.a)(We.a));window.store=qe;var Ke=function(){a.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(L.a,{store:qe,children:Object(d.jsx)(Se.Provider,{value:qe,children:Object(d.jsx)(Ye,{})})})}),document.getElementById("root"))};Ke(),qe.subscribe((function(){Ke()})),c()},34:function(e,t,n){e.exports={containerDialogs:"Dialogs_containerDialogs__29Xah",dialog:"Dialogs_dialog__3pvjr",messages:"Dialogs_messages__1um_Y"}},46:function(e,t,n){e.exports={formControl:"FormsControls_formControl__1Yzl8",error:"FormsControls_error__AzdD7",formSummaryError:"FormsControls_formSummaryError__XDdGG"}},82:function(e,t,n){e.exports={userImg:"User_userImg__3w7RG",selectedNum:"User_selectedNum__1ujW9"}},83:function(e,t,n){e.exports={header:"Header_header__1s8MH",login:"Header_login__2avZh"}}},[[279,1,2]]]);
//# sourceMappingURL=main.8169bf1f.chunk.js.map